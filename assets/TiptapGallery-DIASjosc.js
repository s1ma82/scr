import{k as I,r as m,u as C,l as T,A as x,a as _,j as t,B as k,n as b,v as N}from"./index-CsysWj_3.js";import{u as D,s as n,S as w}from"./SaveAs-2RaeGhZa.js";import{I as o,T as v}from"./Tooltip-CzE2kS4a.js";var E={API_URL:"https://scr.opolo.me/api"};const d="https://placehold.co/2000x400",U=()=>{const{type:p,id:a}=I(),[P,y]=m.useState(!1),[i,l]=D({title:"",link:""}),{focusedArticles:f}=C(e=>e.catalogs),j=T(),[s,u]=m.useState("");m.useEffect(()=>{(async()=>{if(a)try{const e=f.find(c=>c.id===a);if(e){if(e.avatar==="3fa85f64-5717-4562-b3fc-2c963f66afa6")return u(d);l("title",e.title),l("link",e.name),u(e.avatar);return}const r=await x.getArticle(a);console.log("Подгрузка с сервера: ",r),j(_(r))}catch(e){console.error("Ошибка при загрузке данных:",e)}})()},[a,f]);const h=async e=>{const r=e.target.files[0];if(!r)return;const c=await N(r);c&&(u(c),y(!0))},S=async()=>{if(!(!s||s===d||!a))try{const e=await x.saveArticle({id:a,avatar:s,title:i("title"),name:i("link")});b()}catch(e){console.error(e)}},g=s===d?d:`${E.API_URL}/files/${s}`,A=e=>{switch(e){case"banner":return t.jsx(v,{title:"Нажмите, чтобы загрузить изображение",children:t.jsx("div",{children:t.jsx(o,{type:"file",onChange:h,children:t.jsx("img",{style:{maxWidth:"100%"},src:g})})})});case"slider":case"mini-gallery":return t.jsx(v,{title:"Нажмите, чтобы загрузить изображение",children:t.jsx("div",{className:"container",children:t.jsx(o,{type:"file",onChange:h,children:t.jsx("img",{style:{maxWidth:"100%"},src:g})})})})}};return t.jsxs("div",{className:n.tiptapeditor,children:[t.jsx(o,{name:"title",className:n.name,placeholder:"Текст ссылки",onChange:e=>l(e.currentTarget.name,e.currentTarget.value),value:i("title")}),t.jsx(o,{name:"link",className:n.name,placeholder:"ссылка",onChange:e=>l(e.currentTarget.name,e.currentTarget.value),value:i("link")}),p&&A(p),t.jsx("div",{className:n.toolbar,children:t.jsxs(k,{onClick:S,className:n.submit_menu__item,children:[t.jsx(w,{})," Сохранить изменения"]})})]})};export{U as default};
