import{i as I,r as u,u as C,k as T,A as x,a as _,j as t,p as k,w as b}from"./index-Bikxwdcm.js";import{u as N,s as n,S as w}from"./SaveAs-Bqr29o7P.js";import{B as D}from"./index-B3OGdCLe.js";import{I as o,T as y}from"./index-DHKYCD40.js";var E={API_URL:"https://scr.opolo.me/api"};const d="https://placehold.co/2000x400",W=()=>{const{type:p,id:a}=I(),[P,j]=u.useState(!1),[i,c]=N({title:"",link:""}),{focusedArticles:f}=C(e=>e.catalogs),v=T(),[s,m]=u.useState("");u.useEffect(()=>{(async()=>{if(a)try{const e=f.find(l=>l.id===a);if(e){if(e.avatar==="3fa85f64-5717-4562-b3fc-2c963f66afa6")return m(d);c("title",e.title),c("link",e.name),m(e.avatar);return}const r=await x.getArticle(a);console.log("Подгрузка с сервера: ",r),v(_(r))}catch(e){console.error("Ошибка при загрузке данных:",e)}})()},[a,f]);const h=async e=>{const r=e.target.files[0];if(!r)return;const l=await b(r);l&&(m(l),j(!0))},S=async()=>{if(!(!s||s===d||!a))try{const e=await x.saveArticle({id:a,avatar:s,title:i("title"),name:i("link")});k()}catch(e){console.error(e)}},g=s===d?d:`${E.API_URL}/files/${s}`,A=e=>{switch(e){case"banner":return t.jsx(y,{title:"Нажмите, чтобы загрузить изображение",children:t.jsx("div",{children:t.jsx(o,{type:"file",onChange:h,children:t.jsx("img",{style:{maxWidth:"100%"},src:g})})})});case"slider":case"mini-gallery":return t.jsx(y,{title:"Нажмите, чтобы загрузить изображение",children:t.jsx("div",{className:"container",children:t.jsx(o,{type:"file",onChange:h,children:t.jsx("img",{style:{maxWidth:"100%"},src:g})})})})}};return t.jsxs("div",{className:n.tiptapeditor,children:[t.jsx(o,{name:"title",className:n.name,placeholder:"Текст ссылки",onChange:e=>c(e.currentTarget.name,e.currentTarget.value),value:i("title")}),t.jsx(o,{name:"link",className:n.name,placeholder:"ссылка",onChange:e=>c(e.currentTarget.name,e.currentTarget.value),value:i("link")}),p&&A(p),t.jsx("div",{className:n.toolbar,children:t.jsxs(D,{onClick:S,className:n.submit_menu__item,children:[t.jsx(w,{})," Сохранить изменения"]})})]})};export{W as default};
