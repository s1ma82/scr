import{k as I,r as u,u as C,l as T,A as x,a as _,j as t,n as k,v as b}from"./index-UEI1YxYj.js";import{u as N,s as n,S as D}from"./SaveAs-Cze-1JHp.js";import{B as w}from"./index-DYqr8K2Z.js";import{I as o,T as v}from"./Tooltip-waiKIL0u.js";var E={API_URL:"https://scr.opolo.me/api"};const d="https://placehold.co/2000x400",W=()=>{const{type:p,id:a}=I(),[P,y]=u.useState(!1),[i,l]=N({title:"",link:""}),{focusedArticles:f}=C(e=>e.catalogs),j=T(),[s,m]=u.useState("");u.useEffect(()=>{(async()=>{if(a)try{const e=f.find(c=>c.id===a);if(e){if(e.avatar==="3fa85f64-5717-4562-b3fc-2c963f66afa6")return m(d);l("title",e.title),l("link",e.name),m(e.avatar);return}const r=await x.getArticle(a);console.log("Подгрузка с сервера: ",r),j(_(r))}catch(e){console.error("Ошибка при загрузке данных:",e)}})()},[a,f]);const h=async e=>{const r=e.target.files[0];if(!r)return;const c=await b(r);c&&(m(c),y(!0))},S=async()=>{if(!(!s||s===d||!a))try{const e=await x.saveArticle({id:a,avatar:s,title:i("title"),name:i("link")});k()}catch(e){console.error(e)}},g=s===d?d:`${E.API_URL}/files/${s}`,A=e=>{switch(e){case"banner":return t.jsx(v,{title:"Нажмите, чтобы загрузить изображение",children:t.jsx("div",{children:t.jsx(o,{type:"file",onChange:h,children:t.jsx("img",{style:{maxWidth:"100%"},src:g})})})});case"slider":case"mini-gallery":return t.jsx(v,{title:"Нажмите, чтобы загрузить изображение",children:t.jsx("div",{className:"container",children:t.jsx(o,{type:"file",onChange:h,children:t.jsx("img",{style:{maxWidth:"100%"},src:g})})})})}};return t.jsxs("div",{className:n.tiptapeditor,children:[t.jsx(o,{name:"title",className:n.name,placeholder:"Текст ссылки",onChange:e=>l(e.currentTarget.name,e.currentTarget.value),value:i("title")}),t.jsx(o,{name:"link",className:n.name,placeholder:"ссылка",onChange:e=>l(e.currentTarget.name,e.currentTarget.value),value:i("link")}),p&&A(p),t.jsx("div",{className:n.toolbar,children:t.jsxs(w,{onClick:S,className:n.submit_menu__item,children:[t.jsx(D,{})," Сохранить изменения"]})})]})};export{W as default};
